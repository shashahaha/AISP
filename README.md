<div align="center">

  <!-- 标题 -->
  # AISP

  <!-- 副标题 -->
  ### **AI医学标准化病人系统**

  <!-- 徽章 -->
  [![Python](https://img.shields.io/badge/Python-3.10+-blue.svg)](https://www.python.org/)
  [![FastAPI](https://img.shields.io/badge/FastAPI-0.109-green.svg)](https://fastapi.tiangolo.com)
  [![PostgreSQL](https://img.shields.io/badge/PostgreSQL-15+-blue.svg)](https://www.postgresql.org/)
  [![License](https://img.shields.io/badge/License-MIT-yellow.svg)](LICENSE)

  <!-- 简介 -->
  智能医学教育对话系统，提供虚拟患者问诊训练和AI评分功能

  [快速开始](#-快速开始) · [功能特性](#-功能特性) · [系统架构](#-系统架构)

  <!-- 标签 -->
  **标签:** `医学教育` `虚拟患者` `AI评分` `问诊训练` `教育科技`

</div>

---

## 📋 功能特性

### 🤖 AI对话引擎
- **患者角色扮演** - 支持年龄、性格、症状的个性化设定
- **情绪模拟** - 焦虑、疼痛等级等真实情感表达
- **对话管理** - 自动开场白生成与多轮对话历史追踪
- **提示词工程** - 三层提示词管理机制

### 📊 智能评分系统

| 维度 | 权重 | 评分项 |
|:---:|:---:|:------|
| **问诊** | 40% | 关键问题覆盖 · 症状详细询问 · 问诊逻辑性 · 医学礼仪 |
| **诊断** | 35% | 诊断准确性 · 鉴别诊断 · 诊断推理能力 |
| **沟通** | 25% | 对话轮次 · 礼貌表达 · 共情能力 |

### 💾 数据持久化
- **完整的数据库设计** - 用户、会话、病例、评分、学习管理
- **详细评分记录** - 多维度评分分析与改进建议
- **学习追踪** - 知识点掌握度分析与学习路径规划

---

## 🚀 快速开始

### 环境要求
```bash
Python 3.10+
PostgreSQL 15+
```

### 安装部署

```bash
# 克隆项目
git clone https://github.com/shashahaha/AISP.git
cd AISP

# 安装依赖
pip install -r requirements.txt

# 配置环境变量
cp .env.example .env
# 编辑 .env 文件，填入必要的配置信息

# 初始化数据库
python scripts/init_db.py

# 启动服务
uvicorn app.main:app --host 0.0.0.0 --port 8000 --reload
```

访问 API 文档页面查看完整接口说明

---

## 🏗️ 系统架构

```
┌─────────────────────────────────────────────────────────────┐
│                        前端层 (待开发)                        │
└──────────────────────────┬──────────────────────────────────┘
                           │ REST/WebSocket
┌──────────────────────────▼──────────────────────────────────┐
│                     API层                                    │
│   对话接口  /  评分接口  /  学习管理接口                     │
└──────────────────────────┬──────────────────────────────────┘
                           │
┌──────────────────────────▼──────────────────────────────────┐
│                       服务层                                 │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐     │
│  │对话引擎      │  │评分引擎      │  │学习服务      │     │
│  │角色扮演生成  │  │多维度评分    │  │学习追踪      │     │
│  └──────────────┘  └──────────────┘  └──────────────┘     │
└──────────────────────────┬──────────────────────────────────┘
                           │
┌──────────────────────────▼──────────────────────────────────┐
│                  PostgreSQL 数据库                            │
│  用户 / 病例 / 会话 / 评分 / 学习管理等模块                  │
└──────────────────────────┬──────────────────────────────────┘
                           │
┌──────────────────────────▼──────────────────────────────────┐
│                 LLM 服务                                     │
└─────────────────────────────────────────────────────────────┘
```

---

## 📁 项目结构

```
AIMed/
├── app/
│   ├── api/                    # API 路由层
│   ├── core/                   # 核心业务逻辑
│   │   ├── chat_engine.py      # 对话引擎
│   │   ├── prompt_manager.py   # 提示词管理
│   │   └── scoring_engine.py   # 评分引擎
│   ├── services/               # 服务层
│   │   ├── session_service.py  # 会话服务
│   │   └── scoring_service.py  # 评分服务
│   ├── models/                 # 数据模型
│   │   ├── database.py         # 数据库模型
│   │   └── schemas.py          # 数据验证模型
│   ├── db/                     # 数据库配置
│   └── main.py                 # 应用入口
│
├── scripts/                    # 工具脚本
│   ├── init_db.py              # 数据库初始化
│   ├── reset_db.py             # 数据库重置
│   └── migrate_*.py            # 数据迁移脚本
│
├── docs/                       # 文档目录
│   └── database_schema.md      # 数据库设计文档
│
├── .env                        # 环境变量配置
├── requirements.txt            # Python 依赖
├── README.md                   # 项目说明
└── AIserver.md                 # 系统架构文档
```

---

## 📚 文档

| 文档 | 描述 |
|------|------|
| [系统架构文档](AIserver.md) | 完整的系统设计与技术说明 |
| [数据库架构](docs/database_schema.md) | 数据库表结构详细设计 |
| [产品需求文档](AISP系统产品需求文档.md) | 产品功能需求规范 |

---

## 🛠️ 技术栈

| 组件 | 技术 |
|------|------|
| Web 框架 | FastAPI |
| 数据库 | PostgreSQL + SQLAlchemy 2.0 |
| 异步处理 | asyncio + asyncpg |
| 提示词管理 | LangChain |

---

## 📊 数据库设计

```
核心业务
├── 用户管理
├── 病例管理
├── 问诊会话
└── 消息记录

评分系统
├── 评分规则配置
├── 会话评分详情
├── 问题覆盖记录
├── 诊断记录
└── 改进建议

学习管理
├── 学习记录
├── 知识点库
├── 掌握度追踪
├── 学习计划
└── 学习里程碑
```

---

## 📝 许可证

本项目采用 [MIT](LICENSE) 许可证。
